var a=class{constructor(e){let t=this;Object.assign(t,Object.assign({l:window.location,main:document.querySelector("main"),a:"active",headers:{"X-Requested-With":"XMLHttpRequest","X-Ajax-Request":"route"},cache:{},positions:{},referrer:null,noXhrClass:"no-xhr",noCacheClass:"no-cache"},e)),t.init()}init(){let e=this;window.addEventListener("popstate",function(t){e.onPopState.call(e,t)},!1),document.addEventListener("click",t=>{let s=t.target;for(;s;){if(s.matches("a")){e.onClick.call(e,t,s);break}s=s.parentElement}},!1),e.scrollToHash()}onClick(e,t){let s=this,o=t.href?new URL(t.href):!1;if(!(e.defaultPrevented||e.ctrlKey||e.metaKey||e.shiftKey||!o||t.hasAttribute("download")||t.classList.contains(s.noXhrClass)||t.target&&t.target!=="_self"||o.host!==s.l.host)){if(e.preventDefault(),o.pathname!==s.l.pathname||o.search!==s.l.search){history.pushState(null,t.title||document.title,s.sanitizeUrl(t.href)),s.load(t.classList.contains(s.noCacheClass));return}if(o.hash){let n=document.getElementById(o.hash.substring(1));if(n){s.scrollTo(n,s.scrollToHashOffset());return}}s.onUnhandledClick(e,t)}}onUnhandledClick(e,t){}onPopState(e){let t=this;t.isPopState=!0,t.load(),e.preventDefault()}beforeLoad(){return!0}load(e){let t=this;if(t.positions[t.referrer]={x:window.scrollX,y:window.scrollY},t.getRequest(),t.beforeLoad())if(e||!t.cache[t.href]){let s=new XMLHttpRequest;s.open("GET",t.href,!0),Object.keys(t.headers).forEach(o=>{s.setRequestHeader(o,t.headers[o])}),s.onload=function(){if(this.status>=300&&this.status<400){let o=s.getResponseHeader("X-Redirect");o&&(o.indexOf(t.l.host)===-1?t.l.replace(o):(history.replaceState(null,document.title,t.sanitizeUrl(o)),t.load(!1)))}else t.cache[t.href]=this.response,t.afterLoad()},s.send()}else t.afterLoad()}afterLoad(){this.render()}beforeRender(){return!0}render(){let e=this;e.beforeRender()&&(e.renderContent(e.cache[e.href]),e.afterRender()),e.referrer=e.href,e.isPopState=!1}renderContent(e){let t=this;e&&e.trim().startsWith("<!DOC")?location.reload():(t.setInnerHTML(t.main,e),t.resetScrollPosition(),t.scrollToHash())}afterRender(){}resetScrollPosition(){let e=this,t=e.isPopState&&e.positions[e.href];window.scrollTo(t?e.positions[e.href].x:0,t?e.positions[e.href].y:0)}getRequest(){let e=this;e.href=e.sanitizeUrl(e.l.href),e.params=e.l.pathname.replace(/^\//,"").split(/[/?#]/)}sanitizeUrl(e){return e.replace(/\/$/,"")}setInnerHTML(e,t){e.innerHTML=t,Array.from(e.querySelectorAll("script")).forEach(s=>{let o=document.createElement("script");Array.from(s.attributes).forEach(n=>o.setAttribute(n.name,n.value)),o.appendChild(document.createTextNode(s.innerHTML)),s.parentNode.replaceChild(o,s)})}scrollTo(e,t){var s;scroll({top:(typeof e=="number"?e:(s=e.offsetTop)!==null&&s!==void 0?s:0)+(t||0),behavior:"smooth"})}scrollToHash(){let e=this,t=location.hash?document.getElementById(location.hash.substring(1)):null;t&&e.scrollTo(t,e.scrollToHashOffset())}scrollToHashOffset(){return 0}};var r=new a;r.afterRender=()=>{console.log("Hello world")};r.afterRender();
//# sourceMappingURL=site.js.map
